<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CGPA Calculator</title>
<style>
  :root {
    --green: #4caf50;
    --red: #f44336;
    --dark-bg: #1e1e1e;
    --dark-card: #2b2b2b;
    --light-bg: #f5f5f5;
    --light-card: #ffffff;
  }

  body {
    font-family: 'Segoe UI', sans-serif;
    background-color: var(--light-bg);
    color: #222;
    margin: 0;
    padding: 15px;
    transition: background-color 0.3s, color 0.3s;
  }

  .dark-mode {
    background-color: var(--dark-bg);
    color: #f5f5f5;
  }

  .container {
    max-width: 700px;
    margin: auto;
    background: var(--light-card);
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    transition: background 0.3s;
  }

  .dark-mode .container {
    background: var(--dark-card);
  }

  h1 {
    text-align: center;
    margin-bottom: 10px;
  }

  .top-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  #darkToggle {
    background: none;
    border: none;
    font-size: 22px;
    cursor: pointer;
    color: inherit;
  }

  .inputs-row, .course-row, .buttons-row {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin: 10px 0;
  }

  input, select, button {
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #ccc;
    font-size: 15px;
  }

  button {
    cursor: pointer;
    font-weight: 500;
  }

  .add-btn {
    background: var(--green);
    color: white;
    border: none;
  }

  .delete-btn {
    background: var(--red);
    color: white;
    border: none;
  }

  table {
    width: 100%;
    margin-top: 10px;
    border-collapse: collapse;
    font-size: 15px;
  }

  th, td {
    border: 1px solid #999;
    padding: 6px;
    text-align: center;
  }

  .summary {
    text-align: center;
    margin-top: 15px;
  }

  @media (max-width: 480px) {
    .inputs-row, .course-row, .buttons-row {
      flex-direction: column;
      align-items: stretch;
    }
  }
</style>
</head>
<body>

<div class="container">
  <div class="top-row">
    <h1>CGPA Calculator</h1>
    <button id="darkToggle" onclick="toggleDarkMode()">üåô</button>
  </div>

  <div class="inputs-row">
    <input type="number" step="0.01" id="oldCgpa" placeholder="Old CGPA">
    <input type="number" id="oldCredits" placeholder="Old Credits">
    <button class="add-btn" onclick="addOldCgpa()">Add Old CGPA</button>
    <button class="delete-btn" onclick="deleteOldCgpa()">Delete</button>
  </div>
  <hr>

  <div class="course-row">
    <input type="number" id="credits" placeholder="Credits">
    <select id="grade">
      <option value="10">A+</option>
      <option value="9">A</option>
      <option value="8">B+</option>
      <option value="7">B</option>
      <option value="6">C+</option>
      <option value="5">C</option>
      <option value="0">F</option>
    </select>
    <input type="text" id="courseName" placeholder="Course name (optional)">
    <button class="add-btn" onclick="addCourse()">Add</button>
  </div>

  <table id="courseTable">
    <thead>
      <tr>
        <th>#</th>
        <th>Course</th>
        <th>Credits</th>
        <th>Grade</th>
        <th>Score</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="summary">
    <h3>Total Credits: <span id="totalCredits">0</span></h3>
    <h2>CGPA: <span id="cgpa">0.00</span></h2>
  </div>
</div>

<script>
let courses = [];
let oldCgpa = parseFloat(localStorage.getItem("oldCgpa")) || 0;
let oldCredits = parseFloat(localStorage.getItem("oldCredits")) || 0;

document.addEventListener("DOMContentLoaded", () => {
  updateTable();

  // Press Enter to add course
  document.querySelectorAll("#courseName, #credits, #grade").forEach(el => {
    el.addEventListener("keypress", e => {
      if (e.key === "Enter") addCourse();
    });
  });
});

function addCourse() {
  const name = document.getElementById("courseName").value || "-";
  const credits = parseFloat(document.getElementById("credits").value);
  const grade = parseFloat(document.getElementById("grade").value);

  if (isNaN(credits) || credits <= 0) {
    alert("Enter valid credits!");
    return;
  }

  courses.push({ name, credits, grade });
  document.getElementById("courseName").value = "";
  document.getElementById("credits").value = "";

  updateTable();
}

function deleteCourse(index) {
  courses.splice(index, 1);
  updateTable();
}

function updateTable() {
  const tbody = document.querySelector("#courseTable tbody");
  tbody.innerHTML = "";
  let totalCredits = 0;
  let totalPoints = 0;

  courses.forEach((c, i) => {
    const score = c.credits * c.grade;
    totalCredits += c.credits;
    totalPoints += score;

    const row = `<tr>
      <td>${i + 1}</td>
      <td>${c.name}</td>
      <td>${c.credits}</td>
      <td>${getGradeLetter(c.grade)}</td>
      <td>${score.toFixed(2)}</td>
      <td><button class="delete-btn" onclick="deleteCourse(${i})">‚ùå</button></td>
    </tr>`;
    tbody.innerHTML += row;
  });

  document.getElementById("totalCredits").innerText = totalCredits.toFixed(2);

  const totalCombinedCredits = totalCredits + oldCredits;
  const totalCombinedPoints = totalPoints + (oldCgpa * oldCredits);
  const cgpa = totalCombinedCredits ? totalCombinedPoints / totalCombinedCredits : 0;
  document.getElementById("cgpa").innerText = cgpa.toFixed(2);
}

function getGradeLetter(grade) {
  const map = {10: "A+", 9: "A", 8: "B+", 7: "B", 6: "C+", 5: "C", 0: "F"};
  return map[grade] || "-";
}

function addOldCgpa() {
  oldCgpa = parseFloat(document.getElementById("oldCgpa").value) || 0;
  oldCredits = parseFloat(document.getElementById("oldCredits").value) || 0;
  localStorage.setItem("oldCgpa", oldCgpa);
  localStorage.setItem("oldCredits", oldCredits);
  updateTable();
}

function deleteOldCgpa() {
  oldCgpa = 0;
  oldCredits = 0;
  localStorage.removeItem("oldCgpa");
  localStorage.removeItem("oldCredits");
  document.getElementById("oldCgpa").value = "";
  document.getElementById("oldCredits").value = "";
  updateTable();
}

function toggleDarkMode() {
  document.body.classList.toggle("dark-mode");
  const toggle = document.getElementById("darkToggle");
  toggle.textContent = document.body.classList.contains("dark-mode") ? "‚òÄÔ∏è" : "üåô";
}
</script>

</body>
</html>
