<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CGPA Calculator</title>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background-color: #f5f5f5;
    color: #222;
    margin: 0;
    padding: 20px;
    transition: background-color 0.3s, color 0.3s;
  }

  .dark-mode {
    background-color: #1e1e1e;
    color: #f5f5f5;
  }

  h1 {
    text-align: center;
  }

  .container {
    max-width: 700px;
    margin: auto;
    background: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    transition: background-color 0.3s;
  }

  .dark-mode .container {
    background: #2b2b2b;
  }

  input, select, button {
    padding: 10px;
    margin: 5px;
    border-radius: 8px;
    border: 1px solid #ccc;
  }

  button {
    cursor: pointer;
  }

  table {
    width: 100%;
    margin-top: 15px;
    border-collapse: collapse;
  }

  th, td {
    border: 1px solid #999;
    padding: 8px;
    text-align: center;
  }

  #darkToggle {
    position: absolute;
    top: 20px;
    right: 20px;
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
  }

  .dark-mode #darkToggle {
    color: yellow;
  }

</style>
</head>
<body>

<button id="darkToggle" onclick="toggleDarkMode()">üåô</button>
<h1>CGPA Calculator</h1>
<div class="container">
  <div>
    <label>Old CGPA: </label>
    <input type="number" step="0.01" id="oldCgpa" placeholder="e.g. 8.5">
    <label>Old Credits: </label>
    <input type="number" id="oldCredits" placeholder="e.g. 20">
    <button onclick="addOldCgpa()">‚ûï Add Old CGPA</button>
    <button onclick="deleteOldCgpa()">üóëÔ∏è Delete Old CGPA</button>
  </div>
  <hr>

  <div>
    <input type="text" id="courseName" placeholder="Course name (optional)">
    <input type="number" id="credits" placeholder="Credits">
    <select id="grade">
      <option value="10">A+</option>
      <option value="9">A</option>
      <option value="8">B+</option>
      <option value="7">B</option>
      <option value="6">C+</option>
      <option value="5">C</option>
      <option value="0">F</option>
    </select>
    <button onclick="addCourse()">Add</button>
  </div>

  <table id="courseTable">
    <thead>
      <tr>
        <th>#</th>
        <th>Course</th>
        <th>Credits</th>
        <th>Grade</th>
        <th>Score</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h3>Total Credits: <span id="totalCredits">0</span></h3>
  <h2>CGPA: <span id="cgpa">0.00</span></h2>
</div>

<script>
let courses = [];
let oldCgpa = parseFloat(localStorage.getItem("oldCgpa")) || 0;
let oldCredits = parseFloat(localStorage.getItem("oldCredits")) || 0;

document.addEventListener("DOMContentLoaded", () => {
  updateTable();

  // Press Enter to add course
  document.getElementById("credits").addEventListener("keypress", e => {
    if (e.key === "Enter") addCourse();
  });
  document.getElementById("grade").addEventListener("keypress", e => {
    if (e.key === "Enter") addCourse();
  });
  document.getElementById("courseName").addEventListener("keypress", e => {
    if (e.key === "Enter") addCourse();
  });
});

function addCourse() {
  const name = document.getElementById("courseName").value || "-";
  const credits = parseFloat(document.getElementById("credits").value);
  const grade = parseFloat(document.getElementById("grade").value);

  if (isNaN(credits) || credits <= 0) {
    alert("Enter valid credits!");
    return;
  }

  courses.push({ name, credits, grade });
  document.getElementById("courseName").value = "";
  document.getElementById("credits").value = "";

  updateTable();
}

function deleteCourse(index) {
  courses.splice(index, 1);
  updateTable();
}

function updateTable() {
  const tbody = document.querySelector("#courseTable tbody");
  tbody.innerHTML = "";
  let totalCredits = 0;
  let totalPoints = 0;

  courses.forEach((c, i) => {
    const score = c.credits * c.grade;
    totalCredits += c.credits;
    totalPoints += score;

    const row = `<tr>
      <td>${i + 1}</td>
      <td>${c.name}</td>
      <td>${c.credits}</td>
      <td>${getGradeLetter(c.grade)}</td>
      <td>${score.toFixed(2)}</td>
      <td><button onclick="deleteCourse(${i})">‚ùå</button></td>
    </tr>`;
    tbody.innerHTML += row;
  });

  document.getElementById("totalCredits").innerText = totalCredits.toFixed(2);

  const totalCombinedCredits = totalCredits + oldCredits;
  const totalCombinedPoints = totalPoints + (oldCgpa * oldCredits);
  const cgpa = totalCombinedCredits ? totalCombinedPoints / totalCombinedCredits : 0;
  document.getElementById("cgpa").innerText = cgpa.toFixed(2);
}

function getGradeLetter(grade) {
  const map = {10: "A+", 9: "A", 8: "B+", 7: "B", 6: "C+", 5: "C", 0: "F"};
  return map[grade] || "-";
}

function addOldCgpa() {
  oldCgpa = parseFloat(document.getElementById("oldCgpa").value) || 0;
  oldCredits = parseFloat(document.getElementById("oldCredits").value) || 0;
  localStorage.setItem("oldCgpa", oldCgpa);
  localStorage.setItem("oldCredits", oldCredits);
  updateTable();
}

function deleteOldCgpa() {
  oldCgpa = 0;
  oldCredits = 0;
  localStorage.removeItem("oldCgpa");
  localStorage.removeItem("oldCredits");
  document.getElementById("oldCgpa").value = "";
  document.getElementById("oldCredits").value = "";
  updateTable();
}

function toggleDarkMode() {
  document.body.classList.toggle("dark-mode");
  const toggle = document.getElementById("darkToggle");
  toggle.textContent = document.body.classList.contains("dark-mode") ? "‚òÄÔ∏è" : "üåô";
}
</script>

</body>
</html>
